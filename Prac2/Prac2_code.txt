CREATE TABLE HOTEL1 AS SELECT * FROM HOTEL;
CREATE TABLE ROOM1 AS SELECT * FROM ROOM;
CREATE TABLE GUEST1 AS SELECT * FROM GUEST;
CREATE TABLE BOOKING1 AS SELECT * FROM BOOKING;


SELECT * FROM HOTEL1;
SELECT * FROM ROOM1;
SELECT * FROM GUEST1;
SELECT * FROM BOOKING1;

TRUNCATE TABLE BOOKING1;
DELETE FROM GUEST1 WHERE NAME LIKE 'V%';
TRUNCATE TABLE HOTEL1;
TRUNCATE TABLE ROOM1;
ALTER TABLE HOTEL1 DROP COLUMN CITY;
ALTER TABLE ROOM1 DROP COLUMN PRICE;
ALTER TABLE GUEST1 DROP COLUMN ADHAR_NO;
ALTER TABLE BOOKING1 DROP COLUMN ROOM_NO;
ALTER TABLE GUEST1 ADD CITY NUMBER(10);
ALTER TABLE GUEST1 MODIFY CITY VARCHAR2(20);

UPDATE GUEST1 SET CITY='Dehli' where GUEST_NO='G256';
UPDATE GUEST1 SET CITY='Mumbai' where GUEST_NO='G367';
UPDATE GUEST1 SET CITY='Mumbai' where GUEST_NO='G879';
UPDATE GUEST1 SET CITY='Dehli' where GUEST_NO='G230';
UPDATE GUEST1 SET CITY='Pune' where GUEST_NO='G190';


ALTER TABLE HOTEL1
ADD CONSTRAINT HOTEL1_HN
PRIMARY KEY (HOTEL_NO);

ALTER TABLE ROOM1 
ADD CONSTRAINT ROOM1_FK_HOTEL
FOREIGN KEY (HOTEL_NO) REFERENCES HOTEL1(HOTEL_NO) ON DELETE CASCADE;

ALTER TABLE BOOKING1 
ADD CONSTRAINT BOOKING_FK_HOTEL
FOREIGN KEY (HOTEL_NO) REFERENCES HOTEL1(HOTEL_NO) ON DELETE SET NULL;

select constraint_name, constraint_type, table_name, status from user_constraints
where table_name='HOTEL1';
select constraint_name, constraint_type, table_name, status from user_constraints
where table_name='ROOM1';
select constraint_name, constraint_type, table_name, status from user_constraints
where table_name='GUEST1';
select constraint_name, constraint_type, table_name, status from user_constraints
where table_name='BOOKING1';

ALTER TABLE HOTEL1 RENAME TO HOTEL2;
ALTER TABLE BOOKING1 RENAME TO BOOKING2;
ALTER TABLE ROOM1 RENAME TO ROOM2;
ALTER TABLE GUEST1 RENAME TO GUEST2;

ALTER TABLE GUEST2 RENAME COLUMN CITY TO GUEST_CITY;
UPDATE GUEST2 SET GUEST_CITY='Pune' where GUEST_NO='G256';

SELECT GUEST_NO,NAME FROM GUEST WHERE GENDER = 'F';
UPDATE GUEST SET ADHAR_NO=NULL where GUEST_NO='G256';
SELECT GUEST_NO,NAME FROM GUEST WHERE ADHAR_NO IS NULL;
SELECT * FROM ROOM WHERE PRICE>1500;

CREATE TABLE GUEST_AGE AS 
SELECT TRUNC((SYSDATE - TO_DATE(DOB, 'YYYY-MM-DD'))/ 365.25-2000) AS AGE_TODAY,
Guest_No, Name, DOB, Gender, Phone_No FROM GUEST;

SELECT * FROM HOTEL;
SELECT * FROM HOTEL WHERE CITY = 'Mumbai';
SELECT * FROM ((SELECT HOTEL_NO,NAME FROM HOTEL) NATURAL JOIN ROOM);

CREATE TABLE HNR AS
SELECT * FROM (
(SELECT HOTEL_NO,CITY FROM HOTEL) 
NATURAL JOIN 
(SELECT HOTEL_NO,ROOM_NO FROM ROOM));

CREATE TABLE GNB AS
SELECT * FROM (
(SELECT HOTEL_NO,GUEST_NO FROM BOOKING) 
NATURAL JOIN 
(SELECT GUEST_NO,NAME FROM GUEST));

SELECT DISTINCT(NAME), CITY FROM (SELECT * FROM GNB NATURAL JOIN HNR);
SELECT * FROM ROOM WHERE TYPE ='A' ORDER BY PRICE;

DROP TABLE HNR;
DROP TABLE GNB;
DROP TABLE GUEST_AGE;
DROP TABLE BOOKING2;
DROP TABLE GUEST2;
DROP TABLE ROOM2;
DROP TABLE HOTEL2;
DROP TABLE BOOKING1;
DROP TABLE GUEST1;
DROP TABLE ROOM1;
DROP TABLE HOTEL1;