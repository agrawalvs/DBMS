CREATE TABLE SAILOR(
SID INT,
SNAME VARCHAR(30) NOT NULL,
RATING INT,
AGE FLOAT,
CONSTRAINT SAILOR_pk PRIMARY KEY(SID)
);

CREATE TABLE BOAT(
BID INT NOT NULL,
BNAME VARCHAR(30),
COLOR VARCHAR(10),
CONSTRAINT BOAT_pk PRIMARY KEY(BID)
);

CREATE TABLE RESERVE (
SID NUMBER(2) NOT NULL, 
BID NUMBER(3) NOT NULL,
RDAY DATE DEFAULT SYSDATE NOT NULL,
CONSTRAINT RESERVE_PK_SID_BID PRIMARY KEY (SID, BID),
CONSTRAINT RESERVE_FK_SAILOR_SID FOREIGN KEY (SID) REFERENCES SAILOR(SID),
CONSTRAINT RESERVE_FK_BOAT_BID FOREIGN KEY (BID) REFERENCES BOAT(BID)
);

INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (22, 'DUSTIN', 7, 45.0);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (29, 'BRUTUS', 1, 33.0);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (31, 'LUBBER', 8, 55.5);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (32, 'ANDY', 8, 25.5);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (58, 'RUSTY', 10, 35.0);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (64, 'HORATIO', 7, 35.0);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (71, 'ZORBA', 10, 16.0);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (74, 'HORATIO', 9, 35.0);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (85, 'ART', 3, 25.5);
INSERT INTO SAILOR(SID, SNAME, RATING, AGE) VALUES (95, 'BOB', 3, 63.5);


INSERT INTO BOAT (BID,BNAME, COLOR) VALUES (101, 'INTERLAKE', 'BLUE');
INSERT INTO BOAT (BID, BNAME, COLOR) VALUES ( 102,'INTERLAKE', 'RED');
INSERT INTO BOAT ( BID,BNAME, COLOR) VALUES ( 103,'CLIPPER', 'GREEN');
INSERT INTO BOAT (BID, BNAME, COLOR) VALUES (104, 'MARINE', 'RED');

INSERT INTO RESERVE(SID, BID, RDAY) VALUES (22, 101, '10-Oct-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (22, 102, '10-Oct-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (22, 103, '08-Oct-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (22, 104, '07-Oct-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (31, 102, '10-Nov-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (31, 103, '06-Nov-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (31, 104, '12-Nov-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (64, 101, '05-Sep-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (64, 102, '08-Sep-1998');
INSERT INTO RESERVE(SID, BID, RDAY) VALUES (74, 103, '08-Sep-1998');


CREATE VIEW SAILOR1 AS SELECT * FROM SAILOR WHERE SID IN (22, 29, 31, 32, 58, 95);
CREATE VIEW SAILOR2 AS SELECT * FROM SAILOR WHERE SID IN (31, 32, 64, 71, 74);
CREATE VIEW SAILOR3 AS SELECT * FROM SAILOR WHERE SID IN (22, 32, 85, 74);
SELECT * FROM SAILOR1;
SELECT * FROM SAILOR2;
SELECT * FROM SAILOR3;

SELECT S.SID,SNAME,BID,RDAY FROM SAILOR S INNER JOIN RESERVE R ON S.SID = R.SID;

SELECT S.SID,SNAME,BID,RDAY FROM SAILOR S INNER JOIN RESERVE R ON S.SID = R.SID
WHERE EXTRACT(MONTH FROM RDAY) = 11 AND s.SID = 74;
SELECT S.SID,SNAME,BID,RDAY FROM SAILOR S INNER JOIN RESERVE R ON S.SID = R.SID
WHERE to_char(RDAY,'MONTH') LIKE 'NOV%' AND S.SID = 31;

SELECT S.SID,S.SNAME,R.BID,R.RDAY,B.BNAME,COLOR FROM RESERVE R,BOAT B,SAILOR S
WHERE to_char(RDAY,'MONTH') LIKE 'AUG%' AND
R.BID != 101 AND R.SID = S.SID AND
R.BID = B.BID; 
SELECT S.SID,S.SNAME,R.BID,R.RDAY,B.BNAME,COLOR FROM RESERVE R,BOAT B,SAILOR S
WHERE to_char(RDAY,'MONTH') LIKE 'OCT%' AND
R.BID != 101 AND R.SID = S.SID AND
R.BID = B.BID;

SELECT * FROM SAILOR1 S1 LEFT OUTER JOIN SAILOR2 S2 
ON S1.SID = S2.SID
ORDER BY S1.SID;

SELECT * FROM SAILOR1 S1 FULL OUTER JOIN SAILOR2 S2 
ON S1.SID = S2.SID
ORDER BY S1.SID;

SELECT * FROM SAILOR NATURAL JOIN RESERVE;

SELECT * FROM SAILOR3 CROSS JOIN RESERVE;

SELECT DISTINCT(SNAME) FROM SAILOR NATURAL JOIN RESERVE WHERE BID = 103;
 
SELECT DISTINCT(COLOR) FROM 
(SELECT BID FROM SAILOR NATURAL JOIN RESERVE WHERE SNAME ='LUBBER') 
NATURAL JOIN BOAT;

SELECT DISTINCT(SNAME) FROM SAILOR NATURAL JOIN RESERVE;

SELECT DISTINCT(SID), SNAME FROM 
(SELECT SNAME,BID,SID FROM SAILOR NATURAL JOIN RESERVE) 
NATURAL JOIN BOAT WHERE COLOR IN ('RED','GREEN');

SELECT SNAME FROM( 
(SELECT SID FROM RESERVE NATURAL JOIN BOAT WHERE COLOR IN 'RED')
INTERSECT
(SELECT SID FROM RESERVE NATURAL JOIN BOAT WHERE COLOR IN 'GREEN')
) NATURAL JOIN SAILOR;

SELECT SID,SNAME,RATING FROM SAILOR
WHERE RATING >=8 AND SID IN (SELECT SID FROM RESERVE WHERE BID = 103);

SELECT SID,SNAME FROM SAILOR 
WHERE SNAME LIKE '%U%' AND 
SID IN (SELECT SID FROM RESERVE ) ORDER BY SNAME;

SELECT SID,SNAME,AGE FROM SAILOR 
WHERE SNAME LIKE '%U%' AND 
SID IN (SELECT SID FROM RESERVE) ORDER BY SNAME;

SELECT SID, SNAME, AGE, BNAME FROM SAILOR NATURAL JOIN RESERVE NATURAL JOIN BOAT 
WHERE BNAME LIKE '%LAKE%' AND AGE>20;
 
SELECT S.SID,S.SNAME,S.RATING FROM SAILOR S, SAILOR R
WHERE R.SNAME = 'BOB' AND S.RATING>R.RATING;

SELECT * FROM BOAT WHERE BID IN(
SELECT BID FROM 
(SELECT BID FROM BOAT NATURAL JOIN 
RESERVE NATURAL JOIN SAILOR WHERE AGE>40 GROUP BY BID,SID) 
GROUP BY BID  HAVING COUNT(BID)>2);

SELECT * FROM BOAT WHERE BID IN(
SELECT BID FROM 
(SELECT BID FROM BOAT NATURAL JOIN 
RESERVE NATURAL JOIN SAILOR WHERE AGE>40 GROUP BY BID,SID) 
GROUP BY BID  HAVING COUNT(BID)>5);


DROP VIEW SAILOR1;
DROP VIEW SAILOR2;
DROP VIEW SAILOR3;
DROP TABLE RESERVE;
DROP TABLE BOAT;
DROP TABLE SAILOR;